# Lame - 10.10.10.3
![](/images/lame/1. lame.png "Lame Info Card")

Contents:

1. TOC
{:toc}

## Scanning and Enumeration

We start with a basic nmap scan to see what ports are open:

    → nmap -A -T4 10.10.10.3

![](/images/lame/2. nmap.png "nmap results")
![](/images/lame/3. nmap_2.png "nmap results")

So we have ftp, ssh, and smb open.  Normally it would be worth exploring ftp to see if we can access any files that may contain ssh creds since ssh is open as well.  From what we can tell so far, this appears to be some sort of Debian-based Linux machine.

In this case though we see a Unix Samba version - Samba 3.0.20, so let's try searching for that.

![](/images/lame/4. google_samba_exploit.png "Google: Samba 3.0.20-debian exploit")

→ So we have a rapid7 (metasploit) result as well as an exploitdb result.  Let's open both:

https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script

https://www.exploit-db.com/exploits/16320

## Exploitation using Metasploit

https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script

→ The rapid7 website has the following instructions for using the metasploit module:

![](/images/lame/5. metasploit options.png "rapid7 website")

→ So let's try them.  Load up msfconsole and follow the steps:

   ⇒ use exploit/multi/samba/usermap_script

   ⇒ show options

![](/images/lame/6. msf_1.png "metasploit")

→ set rhosts 10.10.10.3

→ show targets

![](/images/lame/7. msf_2.png "metasploit")


→ So we have set the remote host (rhosts, aka the target), and the only target available is Automatic. Let's try and run it.

   ⇒ run

![](/images/lame/8. msf_3.png "metasploit")

![](/images/lame/9. user_flag.png "user flag")

![](/images/lame/10. root_flag.png "root flag")

![](/images/lame/11. exploit_db.png "exploit-db entry")

![](/images/lame/12. google.png "google for the win")

![](/images/lame/13. github_exploit.png "exploit on github")

![](/images/lame/14. edit_code.png "initial shellode")

![](/images/lame/15. msfvenom.png "msfvenom for shellcode")

![](/images/lame/16. edit_shellcode.png "editing the shellcode")

![](/images/lame/17. chmod.png "chmod the script")

![](/images/lame/18. nc_listen.png "listener setup")

![](/images/lame/19. samba_exploit.png "execute the exploit")

![](/images/lame/20. nc_connect.png "nc reverse shell connection")

![](/images/lame/21. flags.png "flags")



## Basic formatting

You can use *italics*, **bold**, `code font text`, and create [links](https://www.markdownguide.org/cheat-sheet/). Here's a footnote [^1]. Here's a horizontal rule:


## Images

![rax logo](/images/rax_intel.jpg)

## Code
